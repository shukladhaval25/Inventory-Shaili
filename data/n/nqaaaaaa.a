Public Class DateWisePackingVI
    Implements IReport
    Dim frmpara As frmPara1
    Public Sub ShowReport() Implements IReport.ShowReport
        frmpara = New frmPara1
        frmpara.strReport = "DW_PackingVI"
        If (frmpara.ShowDialog() = DialogResult.OK) Then
            ShowDateWisePackingVI()
        End If
    End Sub
    Public Sub ShowDateWisePackingVI()
        Dim strsql As String
        Dim ds As New DataSet
        Dim myrpt As New rptDateWisePackingVI
        cmd = New OleDb.OleDbCommand
        cmd.Connection = conn

        dsSub = New DataSet

        strsql = "SELECT FinishGoods_QCMaster.FGVI_NO, format(FinishGoods_QCMaster.VI_Date,'dd/MM/yyyy') as VI_Date, FGMaster.FGName,FinishGoods_QCMaster.PKG_VI_NO, format(FinishGoods_QCMaster.PKG_VI_Date,'dd/MM/yyyy') as PKG_VI_Date, FinishGoods_QCDetail.QC_No, FinishGoods_QCDetail.Batch_NO, Format([Exp_Date],'MM/yyyy') AS ExpDate," _
            & " FinishGoods_QCMaster.CY FROM FGMaster INNER JOIN (FinishGoods_QCMaster INNER JOIN FinishGoods_QCDetail ON FinishGoods_QCMaster.FGVI_NO = FinishGoods_QCDetail.FGVI_NO) " _
            & " ON FGMaster.FID = FinishGoods_QCDetail.FID " _
            & " WHERE (((FinishGoods_QCMaster.PKG_VI_Date) Between #" & Format(frmpara.dtpFrom.EditValue, "MM/dd/yyyy") & "# And #" & Format(frmpara.dtpTo.EditValue, "MM/dd/yyyy") & "#) AND ((FinishGoods_QCMaster.CY)='" & strCY & "'));"
        Dim adp As New OleDb.OleDbDataAdapter
        adp.SelectCommand = New OleDb.OleDbCommand
        adp.SelectCommand.Connection = conn
        adp.SelectCommand.CommandText = strsql
       
        adp.Fill(ds, "DWPVI")

        adp.SelectCommand.CommandText = "Select * from companyMaster"
        adp.Fill(ds, "Company")
        myrpt.DataSource = ds
        myrpt.GroupHeader1.GroupFields.Item(0).FieldName = "PKG_VI_Date"
        myrpt.xrlblPVIDateVal.DataBindings.Add("Text", ds, "DWPVI.PKG_VI_Date")
        myrpt.xrTabCellVINO.DataBindings.Add("Text", ds, "DWPVI.FGVI_NO")
        myrpt.xrTabCellVIDate.DataBindings.Add("Text", ds, "DWPVI.VI_Date")
        myrpt.xrTabCellProduct.DataBindings.Add("Text", ds, "DWPVI.FGName")
        myrpt.xrTabCellBatchNo.DataBindings.Add("Text", ds, "DWPVI.Batch_NO")
        myrpt.xrTabCellPackingVINo.DataBindings.Add("Text", ds, "DWPVI.PKG_VI_NO")
        myrpt.xrTabCellQCQty.DataBindings.Add("Text", ds, "DWPVI.QC_No")
        myrpt.xrTabCellExpDate.DataBindings.Add("Text", ds, "DWPVI.ExpDate")

        myrpt.xrlblCompanytitle.DataBindings.Add("Text", ds, "Company.CompanyName")
        myrpt.xrlblDateValue.Text = Format(Today.Date, "dd/MM/yyyy")
        myrpt.xrlblReportTitle.Text = String.Format(myrpt.xrlblReportTitle.Text, Format(frmpara.dtpFrom.EditValue, "dd/MM/yyyy"), Format(frmpara.dtpTo.EditValue, "dd/MM/yyyy"))


        myrpt.ShowPreview()
        adp.Dispose()
    End Sub
End Class
