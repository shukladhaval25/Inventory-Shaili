Public Class frmitem    
    Inherits DevExpress.XtraEditors.XtraForm

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents GroupControl1 As DevExpress.XtraEditors.GroupControl
    Friend WithEvents Label1 As System.Windows.Forms.Label
    Friend WithEvents Label2 As System.Windows.Forms.Label
    Friend WithEvents Label3 As System.Windows.Forms.Label
    Friend WithEvents Label4 As System.Windows.Forms.Label
    Friend WithEvents Label5 As System.Windows.Forms.Label
    Friend WithEvents Label6 As System.Windows.Forms.Label
    Friend WithEvents Label7 As System.Windows.Forms.Label
    Friend WithEvents txtdno As DevExpress.XtraEditors.TextEdit
    Friend WithEvents txtid As DevExpress.XtraEditors.TextEdit
    Friend WithEvents Label8 As System.Windows.Forms.Label
    Friend WithEvents txtnote As DevExpress.XtraEditors.TextEdit
    Friend WithEvents cbounit As DevExpress.XtraEditors.ComboBoxEdit
    Friend WithEvents txtmno As DevExpress.XtraEditors.TextEdit
    Friend WithEvents cmdsave As DevExpress.XtraEditors.SimpleButton
    Friend WithEvents cmdcancel As DevExpress.XtraEditors.SimpleButton
    Friend WithEvents lblgroupname As System.Windows.Forms.Label
    Friend WithEvents cmbgrname As DevExpress.XtraEditors.ComboBoxEdit
    Friend WithEvents txtName As DevExpress.XtraEditors.TextEdit
    Friend WithEvents txtrol As DevExpress.XtraEditors.TextEdit
    Friend WithEvents txtmqty As DevExpress.XtraEditors.TextEdit
    Friend WithEvents cmdAddGroup As DevExpress.XtraEditors.SimpleButton
    Friend WithEvents cmdAddUnit As DevExpress.XtraEditors.SimpleButton
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.GroupControl1 = New DevExpress.XtraEditors.GroupControl()
        Me.cmdAddUnit = New DevExpress.XtraEditors.SimpleButton()
        Me.cmdAddGroup = New DevExpress.XtraEditors.SimpleButton()
        Me.txtmqty = New DevExpress.XtraEditors.TextEdit()
        Me.txtrol = New DevExpress.XtraEditors.TextEdit()
        Me.txtName = New DevExpress.XtraEditors.TextEdit()
        Me.cmbgrname = New DevExpress.XtraEditors.ComboBoxEdit()
        Me.lblgroupname = New System.Windows.Forms.Label()
        Me.txtnote = New DevExpress.XtraEditors.TextEdit()
        Me.Label7 = New System.Windows.Forms.Label()
        Me.cbounit = New DevExpress.XtraEditors.ComboBoxEdit()
        Me.txtmno = New DevExpress.XtraEditors.TextEdit()
        Me.txtdno = New DevExpress.XtraEditors.TextEdit()
        Me.txtid = New DevExpress.XtraEditors.TextEdit()
        Me.Label1 = New System.Windows.Forms.Label()
        Me.Label6 = New System.Windows.Forms.Label()
        Me.Label5 = New System.Windows.Forms.Label()
        Me.Label4 = New System.Windows.Forms.Label()
        Me.Label3 = New System.Windows.Forms.Label()
        Me.Label2 = New System.Windows.Forms.Label()
        Me.Label8 = New System.Windows.Forms.Label()
        Me.cmdsave = New DevExpress.XtraEditors.SimpleButton()
        Me.cmdcancel = New DevExpress.XtraEditors.SimpleButton()
        CType(Me.GroupControl1, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GroupControl1.SuspendLayout()
        CType(Me.txtmqty.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtrol.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtName.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.cmbgrname.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtnote.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.cbounit.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtmno.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtdno.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtid.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.SuspendLayout()
        '
        'GroupControl1
        '
        Me.GroupControl1.Controls.Add(Me.cmdAddUnit)
        Me.GroupControl1.Controls.Add(Me.cmdAddGroup)
        Me.GroupControl1.Controls.Add(Me.txtmqty)
        Me.GroupControl1.Controls.Add(Me.txtrol)
        Me.GroupControl1.Controls.Add(Me.txtName)
        Me.GroupControl1.Controls.Add(Me.cmbgrname)
        Me.GroupControl1.Controls.Add(Me.lblgroupname)
        Me.GroupControl1.Controls.Add(Me.txtnote)
        Me.GroupControl1.Controls.Add(Me.Label7)
        Me.GroupControl1.Controls.Add(Me.cbounit)
        Me.GroupControl1.Controls.Add(Me.txtmno)
        Me.GroupControl1.Controls.Add(Me.txtdno)
        Me.GroupControl1.Controls.Add(Me.txtid)
        Me.GroupControl1.Controls.Add(Me.Label1)
        Me.GroupControl1.Controls.Add(Me.Label6)
        Me.GroupControl1.Controls.Add(Me.Label5)
        Me.GroupControl1.Controls.Add(Me.Label4)
        Me.GroupControl1.Controls.Add(Me.Label3)
        Me.GroupControl1.Controls.Add(Me.Label2)
        Me.GroupControl1.Controls.Add(Me.Label8)
        Me.GroupControl1.Location = New System.Drawing.Point(8, 8)
        Me.GroupControl1.Name = "GroupControl1"
        Me.GroupControl1.Size = New System.Drawing.Size(544, 208)
        Me.GroupControl1.TabIndex = 0
        '
        'cmdAddUnit
        '
        Me.cmdAddUnit.Location = New System.Drawing.Point(208, 136)
        Me.cmdAddUnit.Name = "cmdAddUnit"
        Me.cmdAddUnit.Size = New System.Drawing.Size(40, 21)
        Me.cmdAddUnit.TabIndex = 16
        Me.cmdAddUnit.Text = "&Add..."
        '
        'cmdAddGroup
        '
        Me.cmdAddGroup.Location = New System.Drawing.Point(208, 104)
        Me.cmdAddGroup.Name = "cmdAddGroup"
        Me.cmdAddGroup.Size = New System.Drawing.Size(40, 21)
        Me.cmdAddGroup.TabIndex = 15
        Me.cmdAddGroup.Text = "&Add..."
        '
        'txtmqty
        '
        Me.txtmqty.EditValue = "0"
        Me.txtmqty.Location = New System.Drawing.Point(369, 132)
        Me.txtmqty.Name = "txtmqty"
        Me.txtmqty.Size = New System.Drawing.Size(168, 20)
        Me.txtmqty.TabIndex = 8
        '
        'txtrol
        '
        Me.txtrol.EditValue = "0"
        Me.txtrol.Location = New System.Drawing.Point(369, 100)
        Me.txtrol.Name = "txtrol"
        Me.txtrol.Size = New System.Drawing.Size(168, 20)
        Me.txtrol.TabIndex = 7
        '
        'txtName
        '
        Me.txtName.EditValue = ""
        Me.txtName.Location = New System.Drawing.Point(80, 72)
        Me.txtName.Name = "txtName"
        Me.txtName.Properties.MaxLength = 50
        Me.txtName.Size = New System.Drawing.Size(457, 20)
        Me.txtName.TabIndex = 2
        '
        'cmbgrname
        '
        Me.cmbgrname.EditValue = ""
        Me.cmbgrname.Location = New System.Drawing.Point(80, 104)
        Me.cmbgrname.Name = "cmbgrname"
        Me.cmbgrname.Properties.Buttons.AddRange(New DevExpress.XtraEditors.Controls.EditorButton() {New DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)})
        Me.cmbgrname.Properties.TextEditStyle = DevExpress.XtraEditors.Controls.TextEditStyles.DisableTextEditor
        Me.cmbgrname.Size = New System.Drawing.Size(120, 20)
        Me.cmbgrname.TabIndex = 3
        '
        'lblgroupname
        '
        Me.lblgroupname.Location = New System.Drawing.Point(8, 104)
        Me.lblgroupname.Name = "lblgroupname"
        Me.lblgroupname.Size = New System.Drawing.Size(72, 16)
        Me.lblgroupname.TabIndex = 9
        Me.lblgroupname.Text = "Group Name"
        '
        'txtnote
        '
        Me.txtnote.EditValue = ""
        Me.txtnote.Location = New System.Drawing.Point(369, 164)
        Me.txtnote.Name = "txtnote"
        Me.txtnote.Properties.MaxLength = 150
        Me.txtnote.Size = New System.Drawing.Size(168, 20)
        Me.txtnote.TabIndex = 9
        '
        'Label7
        '
        Me.Label7.Location = New System.Drawing.Point(281, 132)
        Me.Label7.Name = "Label7"
        Me.Label7.Size = New System.Drawing.Size(88, 23)
        Me.Label7.TabIndex = 8
        Me.Label7.Text = "Min Qty.:"
        '
        'cbounit
        '
        Me.cbounit.EditValue = ""
        Me.cbounit.Location = New System.Drawing.Point(80, 136)
        Me.cbounit.Name = "cbounit"
        Me.cbounit.Properties.Buttons.AddRange(New DevExpress.XtraEditors.Controls.EditorButton() {New DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)})
        Me.cbounit.Properties.TextEditStyle = DevExpress.XtraEditors.Controls.TextEditStyles.DisableTextEditor
        Me.cbounit.Size = New System.Drawing.Size(120, 20)
        Me.cbounit.TabIndex = 4
        '
        'txtmno
        '
        Me.txtmno.EditValue = ""
        Me.txtmno.Location = New System.Drawing.Point(369, 40)
        Me.txtmno.Name = "txtmno"
        Me.txtmno.Properties.MaxLength = 25
        Me.txtmno.Size = New System.Drawing.Size(168, 20)
        Me.txtmno.TabIndex = 6
        '
        'txtdno
        '
        Me.txtdno.EditValue = ""
        Me.txtdno.Location = New System.Drawing.Point(80, 168)
        Me.txtdno.Name = "txtdno"
        Me.txtdno.Properties.MaxLength = 25
        Me.txtdno.Size = New System.Drawing.Size(168, 20)
        Me.txtdno.TabIndex = 5
        '
        'txtid
        '
        Me.txtid.EditValue = ""
        Me.txtid.Location = New System.Drawing.Point(80, 40)
        Me.txtid.Name = "txtid"
        Me.txtid.Properties.MaxLength = 15
        Me.txtid.Size = New System.Drawing.Size(168, 20)
        Me.txtid.TabIndex = 1
        '
        'Label1
        '
        Me.Label1.Location = New System.Drawing.Point(8, 40)
        Me.Label1.Name = "Label1"
        Me.Label1.Size = New System.Drawing.Size(72, 16)
        Me.Label1.TabIndex = 1
        Me.Label1.Text = "Item ID:"
        '
        'Label6
        '
        Me.Label6.Location = New System.Drawing.Point(281, 100)
        Me.Label6.Name = "Label6"
        Me.Label6.Size = New System.Drawing.Size(88, 23)
        Me.Label6.TabIndex = 5
        Me.Label6.Text = "Re Order Level:"
        '
        'Label5
        '
        Me.Label5.Location = New System.Drawing.Point(281, 40)
        Me.Label5.Name = "Label5"
        Me.Label5.Size = New System.Drawing.Size(88, 23)
        Me.Label5.TabIndex = 4
        Me.Label5.Text = "Model No.:"
        '
        'Label4
        '
        Me.Label4.Location = New System.Drawing.Point(8, 168)
        Me.Label4.Name = "Label4"
        Me.Label4.Size = New System.Drawing.Size(72, 16)
        Me.Label4.TabIndex = 3
        Me.Label4.Text = "Drawing No.:"
        '
        'Label3
        '
        Me.Label3.Location = New System.Drawing.Point(8, 136)
        Me.Label3.Name = "Label3"
        Me.Label3.Size = New System.Drawing.Size(72, 16)
        Me.Label3.TabIndex = 2
        Me.Label3.Text = "Unit:"
        '
        'Label2
        '
        Me.Label2.Location = New System.Drawing.Point(8, 72)
        Me.Label2.Name = "Label2"
        Me.Label2.Size = New System.Drawing.Size(72, 16)
        Me.Label2.TabIndex = 1
        Me.Label2.Text = "Item Name:"
        '
        'Label8
        '
        Me.Label8.Location = New System.Drawing.Point(281, 164)
        Me.Label8.Name = "Label8"
        Me.Label8.Size = New System.Drawing.Size(88, 23)
        Me.Label8.TabIndex = 1
        Me.Label8.Text = "Notes:"
        '
        'cmdsave
        '
        Me.cmdsave.Location = New System.Drawing.Point(400, 224)
        Me.cmdsave.Name = "cmdsave"
        Me.cmdsave.Size = New System.Drawing.Size(72, 24)
        Me.cmdsave.TabIndex = 10
        Me.cmdsave.Text = "&Save"
        '
        'cmdcancel
        '
        Me.cmdcancel.DialogResult = System.Windows.Forms.DialogResult.Cancel
        Me.cmdcancel.Location = New System.Drawing.Point(480, 224)
        Me.cmdcancel.Name = "cmdcancel"
        Me.cmdcancel.Size = New System.Drawing.Size(72, 24)
        Me.cmdcancel.TabIndex = 12
        Me.cmdcancel.Text = "&Cancel"
        '
        'frmitem
        '
        Me.AcceptButton = Me.cmdsave
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 14)
        Me.CancelButton = Me.cmdcancel
        Me.ClientSize = New System.Drawing.Size(559, 256)
        Me.Controls.Add(Me.cmdcancel)
        Me.Controls.Add(Me.GroupControl1)
        Me.Controls.Add(Me.cmdsave)
        Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
        Me.MaximizeBox = False
        Me.MinimizeBox = False
        Me.Name = "frmitem"
        Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
        Me.Text = "Raw Material"
        CType(Me.GroupControl1, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GroupControl1.ResumeLayout(False)
        CType(Me.txtmqty.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtrol.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtName.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.cmbgrname.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtnote.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.cbounit.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtmno.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtdno.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtid.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        Me.ResumeLayout(False)

    End Sub

#End Region

    Public strcheck As String
    Dim strunitid As String
    Dim strgroupid As String
    Dim cmd As OleDb.OleDbCommand
    Dim dr As OleDb.OleDbDataReader
    Dim strgrouptype As String

    Private Sub frmitem_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.Load
        If strcheck = "Add" Then
            txtid.Tag = GetMaxNo("Rid", "rmitemmaster", "RM", 10)
        End If
        If strcheck = "Edit" Then
            txtid.Tag = ModMain.strgridid
            cmd = New OleDb.OleDbCommand
            cmd.CommandText = "select * from rmitemmaster where rid ='" & ModMain.strgridid & "'"
            cmd.Connection = conn
            dr = cmd.ExecuteReader()
            dr.Read()
            bind_data()
            dr.Close()
            cmd.Dispose()
        End If
        txtid.Focus()
    End Sub
    Private Sub bind_data()
        Try
            txtid.Tag = dr("RId").ToString

            'itemid 
            If IsDBNull(dr("RMItemID").ToString) = True Then
                txtid.Text = ""
            Else
                txtid.Text = dr("RMItemID").ToString
            End If

            'itemname
            If IsDBNull(dr(2).ToString) = True Then
                txtName.Text = ""
            Else
                txtName.Text = dr(2).ToString
            End If

            'draw no
            If IsDBNull(dr("drawno").ToString) = True Then
                txtdno.Text = ""
            Else
                txtdno.Text = dr("drawno").ToString
            End If

            'mod no
            If IsDBNull(dr("modno").ToString) = True Then
                txtmno.Text = ""
            Else
                txtmno.Text = dr("modno").ToString
            End If

            'rol
            If IsDBNull(dr("rol").ToString) = True Then
                txtrol.Text = ""
            Else
                txtrol.Text = dr("rol").ToString
            End If

            'Min_qty
            If IsDBNull(dr("min_qty").ToString) = True Then
                txtmqty.Text = ""
            Else
                txtmqty.Text = dr("min_qty").ToString
            End If

            'notes'

            If IsDBNull(dr("notes").ToString) = True Then
                txtnote.Text = ""
            Else
                txtnote.Text = dr("notes").ToString
            End If

            strgroupid = dr("groupid").ToString
            strunitid = dr("UnitID").ToString
            dr.Close()

            'groupname
            If strGroupID <> "" Then
                ' dr.Close()
                Dim cmdtemp As New OleDb.OleDbCommand
                cmdtemp.CommandType = CommandType.Text
                cmdtemp.Connection = conn
                cmdtemp.CommandText = "select groupname from groupmaster where groupid = '" & strGroupID & "'"
                Dim strUName As String
                strUName = cmdtemp.ExecuteScalar()
                If strUName Is Nothing Then
                    cmbgrname.Text = ""
                Else
                    cmbgrname.Text = strUName
                End If
                cmdtemp.Dispose()
            Else
                cmbgrname.Text = ""
            End If

            'unitid()
            If strunitid <> "" Then

                Dim cmdtemp As New OleDb.OleDbCommand
                cmdtemp.CommandType = CommandType.Text
                cmdtemp.Connection = conn
                cmdtemp.CommandText = "select unitname from unitmaster where unitid = '" & strunitid & "'"
                Dim strUName1 As String
                strUName1 = cmdtemp.ExecuteScalar()
                If strUName1 Is Nothing Then
                    cbounit.Text = ""
                Else
                    cbounit.Text = strUName1
                End If
                cmdtemp.Dispose()
            Else
                cbounit.Text = ""
            End If

        Catch ex As Exception
            MessageBox.Show(ex.ToString)
        End Try
    End Sub
    Private Sub cmdcancel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdcancel.Click
        Me.Close()
    End Sub

    Private Sub cbounit_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles cbounit.GotFocus
        Try
            FillCombox("UnitMaster", "UnitName", cbounit)
        Catch ex As Exception
            If show_error Then
                MsgBox(ex.ToString)
            End If
        End Try
    End Sub


    Private Sub txtrol_KeyPress(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyPressEventArgs)
        If IsNumeric(e.KeyChar) = False Then
            e.Handled = True
        End If
    End Sub

    Private Sub cbounit_Validating(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles cbounit.Validating
        cmd = New OleDb.OleDbCommand
        cmd.Connection = conn
        cmd.CommandText = "select unitid from unitmaster where unitname = '" & cbounit.Text & "'"
        strunitid = cmd.ExecuteScalar
        cmd.Dispose()
    End Sub

    Private Sub txtrol_GotFocus(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If txtrol.Text = 0 Then
            txtrol.Text = ""
        End If
    End Sub

    Private Sub txtmqty_GotFocus(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If txtmqty.Text = 0 Then
            txtmqty.Text = ""
        End If
    End Sub

    Private Sub txtname_Validating(ByVal sender As System.Object, ByVal e As System.ComponentModel.CancelEventArgs)
        If txtName.Text = "" Then
            e.Cancel = True
        End If
    End Sub
    Private Sub cmdsave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdsave.Click
        Try
            If CheckValiDate() = True Then
                If strcheck = "Add" Then
                    cmd = New OleDb.OleDbCommand("insert into rmitemmaster values ( '" & txtid.Tag & "','" & Replace(txtid.Text.Trim, "'", "''") & "', '" & Replace(txtName.Text.Trim, "'", "''") & "', '" & strgroupid & "','" & strunitid & "' ,'" & Replace(txtdno.Text.Trim, "'", "''") & "', '" & Replace(txtmno.Text.Trim, "'", "''") & "'," & txtrol.Text & ", " & txtmqty.Text & " ,'" & Replace(txtnote.Text.Trim, "'", "''") & "')")
                    cmd.Connection = conn
                    cmd.ExecuteNonQuery()
                ElseIf strcheck = "Edit" Then
                    cmd = New OleDb.OleDbCommand("update Rmitemmaster set RMItemId = '" & Replace(txtid.Text.Trim, "'", "''") & "',rmitemname = '" & Replace(txtName.Text.Trim, "'", "''") & "', GroupID = '" & strgroupid & "', unitid = '" & strunitid & "', drawno = '" & Replace(txtdno.Text.Trim, "'", "''") & "', modno = '" & Replace(txtmno.Text.Trim, "'", "''") & "', rol = " & txtrol.Text & ", min_qty = " & txtmqty.Text & ", notes = '" & Replace(txtnote.Text.Trim, "'", "''") & "' where Rid = '" & txtid.Tag & "'")
                    cmd.Connection = conn
                    cmd.ExecuteNonQuery()
                End If
                cmdsave.Enabled = False
            Else
                Exit Sub
            End If
            DevExpress.XtraEditors.XtraMessageBox.Show(Me, "Save Data Successfully", StrAppName, MessageBoxButtons.OK, MessageBoxIcon.Information)
            Me.Close()
        Catch ex As Exception
            If show_error = True Then
                MessageBox.Show(ex.ToString)
            End If
        Finally
        End Try
    End Sub
    Private Function CheckValiDate() As Boolean
        'NEW
        Dim strItemName As String
        Try
            cmd = New OleDb.OleDbCommand
            cmd.Connection = conn
            If strcheck = "Add" Then
                cmd.CommandText = "select RMItemname from rmitemmaster where rmitemname = '" & Replace(txtName.Text, "'", "''") & "'"
            ElseIf strcheck = "Edit" Then
                cmd.CommandText = "select RMItemname from rmitemmaster where rmitemname = '" & Replace(txtName.Text, "'", "''") & "'"
            End If
            strItemName = cmd.ExecuteScalar
            If strItemName <> "" And strcheck = "Add" Then
                DevExpress.XtraEditors.XtraMessageBox.Show(Me, "This Item Name already exists", StrAppName, MessageBoxButtons.OK, MessageBoxIcon.Information)
                Return False
                Exit Function
            End If
            If txtid.Text = "" Or txtName.Text = "" Or cbounit.Text = "" Or _
               cmbgrname.Text = "" Then
                DevExpress.XtraEditors.XtraMessageBox.Show(Me, "Check either Item ID or Item Name or Group Name or Unit Name is not left blank", StrAppName, MessageBoxButtons.OK, MessageBoxIcon.Information)
                Return False

            End If
            Return True
        Catch ex As Exception
            If show_error Then
                MessageBox.Show(ex.ToString)
            End If
        End Try
    End Function


    Private Sub cmbgrname_Validating(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles cmbgrname.Validating
        If cmbgrname.Text <> "" Then
            cmd = New OleDb.OleDbCommand
            cmd.Connection = conn
            cmd.CommandText = "select groupid from groupmaster where groupname= '" & cmbgrname.Text & "'"
            strgroupid = cmd.ExecuteScalar
            cmd.Dispose()
        End If
    End Sub
    Private Sub cmbgrname_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbgrname.GotFocus
        Try

            cmbgrname.Properties.Items.Clear()
            Dim dr As OleDb.OleDbDataReader
            cmd = New OleDb.OleDbCommand
            cmd.Connection = conn
            cmd.CommandText = "Select GroupName from GroupMaster where GroupType ='R'"
            dr = cmd.ExecuteReader
            Do While dr.Read()
                cmbgrname.Properties.Items.Add(dr.Item(0))
            Loop
            dr.Close()
            cmd.Dispose()
        Catch ex As Exception
            If show_error Then
                MsgBox(ex.ToString)
            End If
        End Try
    End Sub

    Private Sub cmbgrname_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbgrname.LostFocus
        If cmbgrname.Text = "" Then
            cmbgrname.Focus()
        End If
    End Sub

    Private Sub cmbgrname_SelectedValueChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbgrname.SelectedValueChanged
        If cmbgrname.Text <> "" Then
            cmd = New OleDb.OleDbCommand
            cmd.Connection = conn
            cmd.CommandText = "select grouptype from groupmaster where groupname= '" & cmbgrname.Text & "'"
            strgrouptype = cmd.ExecuteScalar
            cmd.Dispose()
        End If
    End Sub


    Private Sub txtrol_Validating(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles txtrol.Validating
        Try
            If IsNumeric(txtrol.Text) = False Then
                e.Cancel = True
                MsgBox("Only Numeric value can be enter", MsgBoxStyle.OKOnly)
            End If
        Catch ex As Exception
            If show_error Then
                MessageBox.Show(ex.ToString)
            End If
        End Try
    End Sub

    Private Sub txtrol_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtrol.LostFocus
        If txtrol.Text = "" Then
            txtrol.Text = 0
        End If
    End Sub

    Private Sub txtmqty_Validating(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles txtmqty.Validating
        Try
            If IsNumeric(txtmqty.Text) = False Then
                e.Cancel = True
                MsgBox("Only Numeric value can be enter", MsgBoxStyle.OKOnly)
            End If
        Catch ex As Exception
            If show_error Then
                MessageBox.Show(ex.ToString)
            End If
        End Try
    End Sub

    Private Sub txtmqty_LostFocus1(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtmqty.LostFocus
        If txtmqty.Text = "" Then
            txtmqty.Text = 0
        End If
    End Sub


    Private Sub cmdAddGroup_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdAddGroup.Click
        Dim frmgroupobj As New frmGroup
        frmgroupobj.strcheck = "Add"
        frmgroupobj.ShowDialog()
    End Sub

    Private Sub cmdAddUnit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdAddUnit.Click
        Dim frmUnit As New FrmUnit
        frmUnit.strCheck = "Add"
        frmUnit.ShowDialog()
    End Sub

    Private Sub cmbgrname_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbgrname.SelectedIndexChanged

    End Sub
End Class


