Public Class frmChangePass
    Inherits DevExpress.XtraEditors.XtraForm

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents GroupControl1 As DevExpress.XtraEditors.GroupControl
    Friend WithEvents Label1 As System.Windows.Forms.Label
    Friend WithEvents lblUserID As System.Windows.Forms.Label
    Friend WithEvents txtUserId As DevExpress.XtraEditors.TextEdit
    Friend WithEvents Label2 As System.Windows.Forms.Label
    Friend WithEvents btnApply As DevExpress.XtraEditors.SimpleButton
    Friend WithEvents btnCancel As DevExpress.XtraEditors.SimpleButton
    Friend WithEvents Label3 As System.Windows.Forms.Label
    Friend WithEvents txtConfPass As DevExpress.XtraEditors.TextEdit
    Friend WithEvents txtNewPass As DevExpress.XtraEditors.TextEdit
    Friend WithEvents txtOldPass As DevExpress.XtraEditors.TextEdit
    Friend WithEvents PicLogin As DevExpress.XtraEditors.PictureEdit
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Dim resources As System.ComponentModel.ComponentResourceManager = New System.ComponentModel.ComponentResourceManager(GetType(frmChangePass))
        Me.GroupControl1 = New DevExpress.XtraEditors.GroupControl
        Me.PicLogin = New DevExpress.XtraEditors.PictureEdit
        Me.txtConfPass = New DevExpress.XtraEditors.TextEdit
        Me.Label3 = New System.Windows.Forms.Label
        Me.txtNewPass = New DevExpress.XtraEditors.TextEdit
        Me.Label2 = New System.Windows.Forms.Label
        Me.txtOldPass = New DevExpress.XtraEditors.TextEdit
        Me.Label1 = New System.Windows.Forms.Label
        Me.lblUserID = New System.Windows.Forms.Label
        Me.txtUserId = New DevExpress.XtraEditors.TextEdit
        Me.btnCancel = New DevExpress.XtraEditors.SimpleButton
        Me.btnApply = New DevExpress.XtraEditors.SimpleButton
        CType(Me.GroupControl1, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GroupControl1.SuspendLayout()
        CType(Me.PicLogin.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtConfPass.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtNewPass.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtOldPass.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.txtUserId.Properties, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.SuspendLayout()
        '
        'GroupControl1
        '
        Me.GroupControl1.Controls.Add(Me.PicLogin)
        Me.GroupControl1.Controls.Add(Me.txtConfPass)
        Me.GroupControl1.Controls.Add(Me.Label3)
        Me.GroupControl1.Controls.Add(Me.txtNewPass)
        Me.GroupControl1.Controls.Add(Me.Label2)
        Me.GroupControl1.Controls.Add(Me.txtOldPass)
        Me.GroupControl1.Controls.Add(Me.Label1)
        Me.GroupControl1.Controls.Add(Me.lblUserID)
        Me.GroupControl1.Controls.Add(Me.txtUserId)
        Me.GroupControl1.Location = New System.Drawing.Point(8, 8)
        Me.GroupControl1.Name = "GroupControl1"
        Me.GroupControl1.Size = New System.Drawing.Size(400, 160)
        Me.GroupControl1.TabIndex = 0
        Me.GroupControl1.Text = "Change Password"
        '
        'PicLogin
        '
        Me.PicLogin.EditValue = CType(resources.GetObject("PicLogin.EditValue"), Object)
        Me.PicLogin.Location = New System.Drawing.Point(8, 24)
        Me.PicLogin.Name = "PicLogin"
        Me.PicLogin.Properties.Appearance.BackColor = System.Drawing.Color.Transparent
        Me.PicLogin.Properties.Appearance.Options.UseBackColor = True
        Me.PicLogin.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder
        Me.PicLogin.Properties.ShowMenu = False
        Me.PicLogin.Size = New System.Drawing.Size(96, 112)
        Me.PicLogin.TabIndex = 27
        '
        'txtConfPass
        '
        Me.txtConfPass.EditValue = ""
        Me.txtConfPass.Location = New System.Drawing.Point(224, 120)
        Me.txtConfPass.Name = "txtConfPass"
        Me.txtConfPass.Properties.Appearance.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.txtConfPass.Properties.Appearance.Options.UseFont = True
        Me.txtConfPass.Properties.MaxLength = 20
        Me.txtConfPass.Properties.PasswordChar = Global.Microsoft.VisualBasic.ChrW(42)
        Me.txtConfPass.Size = New System.Drawing.Size(168, 22)
        Me.txtConfPass.TabIndex = 4
        '
        'Label3
        '
        Me.Label3.AutoSize = True
        Me.Label3.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label3.Location = New System.Drawing.Point(112, 120)
        Me.Label3.Name = "Label3"
        Me.Label3.Size = New System.Drawing.Size(117, 16)
        Me.Label3.TabIndex = 26
        Me.Label3.Text = "Confirm Password:"
        '
        'txtNewPass
        '
        Me.txtNewPass.EditValue = ""
        Me.txtNewPass.Location = New System.Drawing.Point(224, 88)
        Me.txtNewPass.Name = "txtNewPass"
        Me.txtNewPass.Properties.Appearance.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.txtNewPass.Properties.Appearance.Options.UseFont = True
        Me.txtNewPass.Properties.MaxLength = 20
        Me.txtNewPass.Properties.PasswordChar = Global.Microsoft.VisualBasic.ChrW(42)
        Me.txtNewPass.Size = New System.Drawing.Size(168, 22)
        Me.txtNewPass.TabIndex = 3
        '
        'Label2
        '
        Me.Label2.AutoSize = True
        Me.Label2.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label2.Location = New System.Drawing.Point(112, 88)
        Me.Label2.Name = "Label2"
        Me.Label2.Size = New System.Drawing.Size(97, 16)
        Me.Label2.TabIndex = 22
        Me.Label2.Text = "New Password:"
        '
        'txtOldPass
        '
        Me.txtOldPass.EditValue = ""
        Me.txtOldPass.Location = New System.Drawing.Point(224, 56)
        Me.txtOldPass.Name = "txtOldPass"
        Me.txtOldPass.Properties.Appearance.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.txtOldPass.Properties.Appearance.Options.UseFont = True
        Me.txtOldPass.Properties.MaxLength = 20
        Me.txtOldPass.Properties.PasswordChar = Global.Microsoft.VisualBasic.ChrW(42)
        Me.txtOldPass.Size = New System.Drawing.Size(168, 22)
        Me.txtOldPass.TabIndex = 2
        '
        'Label1
        '
        Me.Label1.AutoSize = True
        Me.Label1.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label1.Location = New System.Drawing.Point(112, 56)
        Me.Label1.Name = "Label1"
        Me.Label1.Size = New System.Drawing.Size(91, 16)
        Me.Label1.TabIndex = 20
        Me.Label1.Text = "Old Password:"
        '
        'lblUserID
        '
        Me.lblUserID.AutoSize = True
        Me.lblUserID.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.lblUserID.Location = New System.Drawing.Point(112, 24)
        Me.lblUserID.Name = "lblUserID"
        Me.lblUserID.Size = New System.Drawing.Size(55, 16)
        Me.lblUserID.TabIndex = 18
        Me.lblUserID.Text = "User ID:"
        '
        'txtUserId
        '
        Me.txtUserId.EditValue = ""
        Me.txtUserId.Location = New System.Drawing.Point(224, 24)
        Me.txtUserId.Name = "txtUserId"
        Me.txtUserId.Properties.Appearance.Font = New System.Drawing.Font("Tahoma", 9.75!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.txtUserId.Properties.Appearance.Options.UseFont = True
        Me.txtUserId.Properties.MaxLength = 15
        Me.txtUserId.Properties.ReadOnly = True
        Me.txtUserId.Size = New System.Drawing.Size(168, 22)
        Me.txtUserId.TabIndex = 1
        Me.txtUserId.TabStop = False
        '
        'btnCancel
        '
        Me.btnCancel.Location = New System.Drawing.Point(328, 176)
        Me.btnCancel.Name = "btnCancel"
        Me.btnCancel.Size = New System.Drawing.Size(75, 23)
        Me.btnCancel.TabIndex = 6
        Me.btnCancel.Text = "&Cancel"
        '
        'btnApply
        '
        Me.btnApply.Location = New System.Drawing.Point(248, 176)
        Me.btnApply.Name = "btnApply"
        Me.btnApply.Size = New System.Drawing.Size(75, 23)
        Me.btnApply.TabIndex = 5
        Me.btnApply.Text = "&Apply"
        '
        'frmChangePass
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 14)
        Me.ClientSize = New System.Drawing.Size(418, 207)
        Me.ControlBox = False
        Me.Controls.Add(Me.GroupControl1)
        Me.Controls.Add(Me.btnApply)
        Me.Controls.Add(Me.btnCancel)
        Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
        Me.Name = "frmChangePass"
        Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
        Me.Text = "Change Password"
        CType(Me.GroupControl1, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GroupControl1.ResumeLayout(False)
        Me.GroupControl1.PerformLayout()
        CType(Me.PicLogin.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtConfPass.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtNewPass.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtOldPass.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.txtUserId.Properties, System.ComponentModel.ISupportInitialize).EndInit()
        Me.ResumeLayout(False)

    End Sub

#End Region
    Dim strOldPass As String

    Private Sub frmChangePass_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Try
            Dim dRead As OleDb.OleDbDataReader
            cmd = New OleDb.OleDbCommand
            cmd.Connection = conn
            cmd.CommandText = "select * from usermaster where uid ='" & strGVUserID.Trim & "'"
            dRead = cmd.ExecuteReader()
            Do While dRead.Read
                txtUserId.Text = dRead.Item("UserID")
                strOldPass = dRead.Item("Pass")
            Loop
            dRead.Close()
            cmd.Dispose()
        Catch ex As Exception
            If show_error Then
                MsgBox(ex.ToString)
            End If
        End Try
    End Sub

    Private Sub btnApply_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnApply.Click
        Try
            If txtNewPass.Text = "" Or txtConfPass.Text = "" Then
                DevExpress.XtraEditors.XtraMessageBox.Show("Please enter password.", "Change Password", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Exit Sub
            End If
            If txtOldPass.Text = strOldPass Then
                If txtNewPass.Text = txtConfPass.Text Then
                    cmd = New OleDb.OleDbCommand
                    cmd.Connection = conn
                    cmd.CommandText = "Update usermaster set pass ='" & txtNewPass.Text.Trim & "' where uid ='" & strGVUserID.ToString & "' and userid ='" & txtUserId.Text & "'"
                    cmd.ExecuteNonQuery()
                    DevExpress.XtraEditors.XtraMessageBox.Show("New password has been updated.", "Change Password", MessageBoxButtons.OK, MessageBoxIcon.Information)
                    Me.Close()
                Else
                    DevExpress.XtraEditors.XtraMessageBox.Show("New password and confirm pasword does not match.", "Change Password", MessageBoxButtons.OK, MessageBoxIcon.Information)
                    Exit Sub
                End If
            Else
                DevExpress.XtraEditors.XtraMessageBox.Show("Invalid Password", "Change Password", MessageBoxButtons.OK, MessageBoxIcon.Stop)
            End If

        Catch ex As Exception
            If show_error Then
                MsgBox(ex.ToString)
            End If
        End Try
    End Sub

    Private Sub btnCancel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCancel.Click
        Me.Close()
    End Sub
End Class

